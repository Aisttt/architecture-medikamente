# Новые блоки архитектуры C4 с Privacy by Design - "Медикаменте"

## 1. Обзор целевой архитектуры

Целевая архитектура построена на принципах Privacy by Design с разделением на домены и централизованными сервисами безопасности.

## 2. Новые блоки архитектуры C4

### 2.1 Слой безопасности и приватности (Privacy & Security Layer)

#### Identity & Access Management (IAM) Service
**Назначение:** Централизованное управление доступом  
**Privacy by Design:**
- Минимальные права доступа по умолчанию
- Ролевая модель (врач видит только медданные, кассир - только платежи)
- Аудит всех операций доступа

#### Data Classification Service  
**Назначение:** Автоматическая классификация и тегирование данных  
**Privacy by Design:**
- Автоматическое присвоение уровней конфиденциальности
- Применение политик защиты на основе тегов
- Отслеживание жизненного цикла данных

#### Encryption Service
**Назначение:** Сквозное шифрование данных  
**Privacy by Design:**
- Шифрование по умолчанию для всех ПД
- Управление ключами шифрования
- Шифрование в покое, при передаче, при обработке

#### Audit & Compliance Service
**Назначение:** Мониторинг соблюдения требований 152-ФЗ  
**Privacy by Design:**
- Автоматическое логирование операций с ПД
- Контроль соблюдения политик приватности
- Генерация отчётов для регуляторов

### 2.2 Доменные сервисы

#### Patient Domain Service
**Назначение:** Управление данными пациентов  
**Privacy by Design:**
- Пациент контролирует доступ к своим данным
- Минимизация сбора ПД (только необходимые для лечения)
- Автоматическое удаление данных по истечении сроков

#### Medical Records Domain Service  
**Назначение:** Управление медицинскими картами  
**Privacy by Design:**
- Доступ только авторизованному медперсоналу
- Версионирование с защитой от несанкционированных изменений
- Обезличивание для исследовательских целей

#### Billing Domain Service
**Назначение:** Обработка платежей  
**Privacy by Design:**
- Токенизация платёжных данных
- Разделение финансовых и медицинских данных
- Минимальное хранение платёжной информации

#### Laboratory Integration Service
**Назначение:** Интеграция с внешними лабораториями  
**Privacy by Design:**
- Защищённые API с OAuth 2.0
- Шифрование передаваемых данных
- Контроль доступа партнёров к минимально необходимым данным

### 2.3 Интеграционный слой

#### API Gateway
**Назначение:** Единая точка входа для всех API  
**Privacy by Design:**
- Аутентификация и авторизация всех запросов
- Логирование обращений к ПД
- Rate limiting для предотвращения атак

#### Data Integration Hub
**Назначение:** Безопасная интеграция данных между системами  
**Privacy by Design:**
- Обезличивание данных при передаче между доменами
- Контроль целостности данных
- Аудит всех операций интеграции

### 2.4 Пользовательский интерфейс

#### Patient Portal
**Назначение:** Портал для пациентов  
**Privacy by Design:**
- Доступ только к собственным данным пациента
- Прозрачность: пациент видит, кто обращался к его данным
- Контроль согласий на обработку ПД

#### Staff Portal  
**Назначение:** Портал для сотрудников  
**Privacy by Design:**
- Доступ строго по ролям и необходимости
- Маскирование чувствительных данных в интерфейсе
- Уведомления о попытках доступа к ограниченным данным

#### Mobile Application
**Назначение:** Мобильное приложение для пациентов  
**Privacy by Design:**
- Локальная аутентификация (биометрия, PIN)
- Минимальное кеширование данных на устройстве
- Автоматический logout при неактивности

## 3. Принципы взаимодействия блоков

### 3.1 Централизованная безопасность
Все доменные сервисы взаимодействуют через слой безопасности:
- IAM Service авторизует каждый запрос
- Data Classification Service применяет политики
- Encryption Service шифрует данные автоматически

### 3.2 Минимизация данных
Каждый сервис получает только минимально необходимые данные:
- Patient Portal не имеет доступа к финансовым данным
- Billing Service не видит медицинские диагнозы
- Laboratory Service получает только необходимые для анализа данные

### 3.3 Прозрачность и контроль
Пациент имеет полный контроль над своими данными:
- Просмотр истории доступа к данным
- Управление согласиями на обработку
- Запрос на удаление данных
