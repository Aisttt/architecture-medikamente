# Инструменты и меры для обеспечения конфиденциальности - "Медикаменте"

## 1. Комплексная схема защиты данных

### Обновлённые диаграммы потоков данных с мерами защиты

#### 1.1 Защищённый процесс записи пациента

![Защищённый процесс записи пациента](./diagrams/secure_patient_registration.svg)

<details>
<summary>Код PlantUML диаграммы</summary>

```plantuml
@startuml secure_patient_registration
!theme plain
skinparam backgroundColor white
skinparam defaultFontSize 10

' Внешние сущности
rectangle "ПАЦИЕНТ\n+ Согласие ПД\n✅ ЗАЩИЩЕНО" as patient #lightgreen

' Процессы (защищённые)
circle "РЕСЕПШЕН\n+ MFA\n✅ ОК" as reception #lightgreen
circle "СОЗДАНИЕ\nМЕДКАРТЫ\n✅ ОК" as create_record #lightgreen
rectangle "ВРАЧ + MFA\n✅ ОК" as doctor #lightgreen

' Системы безопасности
rectangle "DLP СИСТЕМА\n✅ ЗАЩИТА" as dlp #orange
rectangle "SIEM МОНИТОРИНГ\n✅ КОНТРОЛЬ" as siem #orange

' Хранилища (защищённые)
database "ЗАЩИЩЁННАЯ БД\nAES-256\n✅ ЗАЩИЩЕНО" as secure_db #lightgreen
database "СИСТЕМА ТЕГИРОВАНИЯ\nPII_BASIC\n✅ ЗАЩИЩЕНО" as tagging #lightgreen
database "ЗАЩИЩЁННОЕ ХРАНИЛИЩЕ\n+ Аудит + Версии\n✅ ЗАЩИЩЕНО" as secure_storage #lightgreen

' Потоки данных
patient --> reception : "Согласие на\nобработку ПД"
dlp --> reception : "Контроль\nутечек"
dlp --> doctor : "Контроль\nутечек"

reception --> secure_db : "Шифрование\nAES-256"
reception --> tagging : "Тегирование:\nPII_BASIC"

secure_db --> doctor : "RBAC:\nDoctor_Only"
doctor --> create_record : "Цифровая\nподпись"
create_record --> secure_storage : "Зашифрованная\nмедкарта"

siem --> secure_db : "Наблюдение"
siem --> secure_storage : "Наблюдение"

' Улучшения безопасности
note bottom of reception : УЛУЧШЕНИЯ:\n✅ MFA для всех пользователей\n✅ Шифрование AES-256
note bottom of tagging : ✅ Система тегирования данных
note bottom of dlp : ✅ DLP предотвращение утечек
note bottom of siem : ✅ SIEM мониторинг\n✅ Аудит всех операций

@enduml
```

</details>

#### 1.2 Защищённый процесс обработки анализов

![Защищённый процесс обработки анализов](./diagrams/secure_lab_results_dfd.svg)

<details>
<summary>Код PlantUML диаграммы</summary>

```plantuml
@startuml secure_lab_results_dfd
!theme plain
skinparam backgroundColor white
skinparam defaultFontSize 10

' Внешние сущности
rectangle "ВНЕШНЯЯ\nЛАБОРАТОРИЯ\n✅ ПАРТНЁР" as lab #lightgreen

' Процессы (защищённые)
circle "ЗАЩИЩЁННАЯ\nПОЧТА\n✅ S/MIME" as secure_mail #lightgreen
circle "ИНТЕГРАЦИОННЫЙ\nШЛЮЗ\n✅ ЗАЩИЩЁН" as gateway #lightgreen
rectangle "ВРАЧ\n✅ ОК" as doctor #lightgreen

' Системы безопасности
rectangle "HSM КЛЮЧИ\n✅ АППАРАТНАЯ\nЗАЩИТА" as hsm #lightgreen
rectangle "DATA LINEAGE\n✅ ОТСЛЕЖИВАНИЕ" as lineage #lightblue
rectangle "BACKUP СИСТЕМА\n✅ РЕЗЕРВЫ" as backup #orange

' Хранилища (защищённые)
database "СИСТЕМА\nТЕГИРОВАНИЯ\nPHI_TESTS\n✅ ЗАЩИЩЕНО" as tagging #lightgreen
database "ЗАЩИЩЁННОЕ\nХРАНИЛИЩЕ\nШифр.+подпись\n✅ ЗАЩИЩЕНО" as secure_storage #lightgreen

' Аналитика
rectangle "ML/ANALYTICS\nПЛАТФОРМА\n✅ ОБЕЗЛИЧЕНО" as analytics #yellow

' Потоки данных
lab --> secure_mail : "S/MIME\nшифрование"
secure_mail --> gateway : "API с\nOAuth 2.0"
hsm --> gateway : "Аппаратные\nключи"

gateway --> tagging : "Автотегирование:\nPHI_TESTS"
gateway --> secure_storage : "Шифрование +\nподпись"

lineage --> gateway : "Трассировка"
lineage --> secure_storage : "Отслеживание"
backup --> secure_storage : "Резервное\nкопирование"

secure_storage --> doctor : "RBAC:\nMedical_Staff"
doctor --> analytics : "Обезличивание"

' Улучшения безопасности
note bottom of secure_mail : УЛУЧШЕНИЯ:\n✅ S/MIME шифрование передачи\n✅ OAuth 2.0 аутентификация API
note bottom of hsm : ✅ HSM для критичных ключей
note bottom of tagging : ✅ Автоматическое тегирование
note bottom of lineage : ✅ Data Lineage отслеживание
note bottom of backup : ✅ Резервное копирование
note bottom of analytics : ✅ Обезличивание для аналитики

@enduml
```

</details>

---

## 2. Инструменты по категориям

### 2.1 Шифрование и криптография

| Инструмент | Назначение | Применение в "Медикаменте" | Стоимость | Приоритет |
|------------|------------|---------------------------|-----------|-----------|
| **BitLocker** | Полнодисковое шифрование | Все ПК и серверы | Включено в Windows | Критический |
| **VeraCrypt** | Шифрование файлов и контейнеров | Медицинские документы | Бесплатно | Критический |
| **Windows BitLocker** | Шифрование дисков | Все рабочие станции и серверы | Включено в Windows | Критический |
| **7-Zip с паролем** | Шифрование архивов | Медицинские документы для передачи | Бесплатно | Высокий |
| **S/MIME в Outlook** | Шифрование email | Защищённая переписка с лабораториями | Включено в Office | Средний |

### 2.2 Контроль доступа и аутентификация

| Инструмент | Назначение | Применение в "Медикаменте" | Стоимость | Приоритет |
|------------|------------|---------------------------|-----------|-----------|
| **Microsoft Active Directory** | Централизованная аутентификация | Базовая система доступа | $6/пользователь/месяц | Критический |
| **Azure AD Premium** | Расширенное управление доступом | MFA, условный доступ | $6-22/пользователь/месяц | Критический |
| **Keycloak** | Open Source IAM | Альтернатива Azure AD | Бесплатно | Высокий |
| **CyberArk** | Управление привилегированными учётками | Администраторские доступы | $30,000+/год | Средний |
| **Duo Security** | Двухфакторная аутентификация | MFA для всех сотрудников | $3/пользователь/месяц | Критический |
| **YubiKey** | Аппаратные токены | Физическая 2FA | $50/токен | Средний |

### 2.3 Мониторинг и аудит

| Инструмент | Назначение | Применение в "Медикаменте" | Стоимость | Приоритет |
|------------|------------|---------------------------|-----------|-----------|
| **Windows Event Log** | Журналирование событий | Отслеживание доступа к файлам | Включено в Windows | Высокий |
| **Elastic Security** | Централизованные логи | Сбор логов с серверов и ПК | Бесплатная версия | Средний |
| **Varonis** | Анализ поведения пользователей | Обнаружение аномалий доступа | $50,000+/год | Средний |
| **Netwrix Auditor** | Аудит изменений в системах | Отслеживание изменений в 1С, AD | $1,500/сервер/год | Средний |
| **OSSEC** | Host-based IDS | Мониторинг серверов | Бесплатно | Низкий |

### 2.4 Предотвращение утечек данных (DLP)

| Инструмент | Назначение | Применение в "Медикаменте" | Стоимость | Приоритет |
|------------|------------|---------------------------|-----------|-----------|
| **Microsoft Purview** | DLP для Office 365 | Контроль утечек через email | $2-10/пользователь/месяц | Высокий |
| **Symantec DLP** | Комплексная DLP система | Полный контроль утечек | $50-100/пользователь/год | Высокий |
| **Forcepoint DLP** | Защита от утечек данных | Контроль всех каналов | $40-80/пользователь/год | Высокий |
| **Digital Guardian** | Endpoint DLP | Защита рабочих станций | $30-60/устройство/год | Средний |
| **CoSoSys Endpoint Protector** | USB и email контроль | Базовая защита от утечек | $25/устройство/год | Средний |

### 2.5 Резервное копирование и восстановление

| Инструмент | Назначение | Применение в "Медикаменте" | Стоимость | Приоритет |
|------------|------------|---------------------------|-----------|-----------|
| **Veeam Backup** | Резервное копирование | Backup серверов и БД | $400-800/сокет | Критический |
| **Acronis Cyber Backup** | Backup с защитой от ransomware | Защищённые бэкапы | $69-179/рабочее место | Критический |
| **Azure Backup** | Облачное резервирование | Offsite backup | $0.10/ГБ/месяц | Высокий |
| **Commvault** | Enterprise backup решение | Для больших объёмов данных | $50,000+/год | Низкий |
| **Duplicati** | Open Source backup | Бюджетное решение | Бесплатно | Средний |

---

## 3. Специализированные медицинские решения

### 3.1 Медицинские информационные системы

| Решение | Назначение | Преимущества | Соответствие |
|---------|------------|--------------|--------------|
| **МИС ДОКА+** | Российская МИС | Соответствие 152-ФЗ, интеграция с 1С | 152-ФЗ, Приказ 911н |
| **Медиалог** | Облачная МИС | Быстрое внедрение, SaaS модель | 152-ФЗ |
| **БАРС.Здравоохранение** | Комплексная МИС | Полная автоматизация | Все российские стандарты |
| **Интерин** | МИС для частных клиник | Специализация на частной медицине | 152-ФЗ |

### 3.2 Интеграция с лабораториями

| Решение | Назначение | Безопасность |
|---------|------------|--------------|
| **HL7 FHIR** | Стандарт обмена медданными | Встроенное шифрование |
| **ЛИМС Лаборатория** | Российская ЛИМС | Соответствие требованиям |
| **Roche CobasLink** | Интеграция с анализаторами | Защищённые протоколы |

---

## 4. Архитектура безопасности


### 4.2 Рекомендуемая архитектура для "Медикаменте"

```yaml
Сетевая_Архитектура:
  DMZ:
    - Web-портал для пациентов
    - API Gateway
    - Load Balancer
  
  Internal_Network:
    - Серверы приложений
    - База данных
    - Файловое хранилище
  
  Management_Network:
    - SIEM система
    - Backup серверы
    - Мониторинг

Защитные_Компоненты:
  Периметр:
    - Fortinet FortiGate (Next-Gen Firewall)
    - Suricata (IDS/IPS)
    - ModSecurity (WAF)
  
  Внутренняя_сеть:
    - Microsoft Defender for Endpoint
    - CrowdStrike Falcon (EDR)
    - Cisco ISE (Network Access Control)
  
  Данные:
    - BitLocker (диски)
    - TDE для SQL Server
    - Azure Information Protection
```

---

